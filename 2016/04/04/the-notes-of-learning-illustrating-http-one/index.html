<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 《图解 HTTP》读书笔记（一） · Qi Tang's Blog</title><meta name="description" content="《图解 HTTP》读书笔记（一） - Qi Tang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://imtangqi.com/atom.xml" title="Qi Tang's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/logo.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/qiktang" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/tangqi92" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">《图解 HTTP》读书笔记（一）</h1><div class="post-info">Apr 4, 2016</div><div class="post-content"><h2 id="前言">前言</h2><p>由于最近一段时间在找实习，所以陆陆续续面试了几家公司，可结果都跪了….</p>
<p>总结失败的原因有很多，如果要进行个排名的话，<strong>网络</strong>一定能进前三。每每被面试官问到网络相关知识的时候，我都是一脸懵逼样，支支吾吾说不出个所以然。</p>
<p>现在想想，做移动端也有些日子了，可网络知识这块居然只知胜少，究其原因就是自己不求上进，直到找工作的时候被现实打脸了才恍然醒悟。于是，痛定思痛，决定恶补下网络知识，一番 Google 后，决定以《图解 HTTP》作为入门书籍。当然好记性不如烂笔头，读书笔记是少不了的。</p>
<a id="more"></a> 
<hr>
<h2 id="第_1_章_了解_Web_及网络基础">第 1 章 了解 Web 及网络基础</h2><h3 id="1-1_使用_HTTP_协议访问_Web">1.1  使用 HTTP 协议访问 Web</h3><p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-1.1.jpg" alt=""></p>
<h4 id="1-1-1_从输入_URL_到页面加载完成的过程中都发生了什么事情？">1.1.1 从输入 URL 到页面加载完成的过程中都发生了什么事情？</h4><ol>
<li>在浏览器里输入网址</li>
<li>浏览器查找域名的 IP 地址</li>
<li>浏览器给 Web 服务器发送一个 HTTP 请求</li>
<li>Facebook 服务的永久重定向响应</li>
<li>浏览器跟踪重定向地址</li>
<li>服务器「处理」请求</li>
<li>服务器发回一个 HTML 响应</li>
<li>浏览器开始显示HTML</li>
<li>浏览器发送获取嵌入在 HTML 中的对象</li>
<li>浏览器发送异步（AJAX）请求</li>
</ol>
<p>详情参见：</p>
<ul>
<li><a href="https://github.com/skyline75489/what-happens-when-zh_CN" target="_blank" rel="external">当···时发生了什么？</a></li>
<li><a href="http://fex.baidu.com/blog/2014/05/what-happen/" target="_blank" rel="external">从输入 URL 到页面加载完成的过程中都发生了什么事情？</a></li>
<li><a href="https://www.zhihu.com/question/34873227" target="_blank" rel="external">当在浏览器地址栏输入一个URL后回车，将会发生的事情？</a></li>
</ul>
<h3 id="1-2_HTTP_历史">1.2  HTTP 历史</h3><h4 id="1-2-1_HTTP_1-0_vs_HTTP_1-1">1.2.1  HTTP 1.0 vs HTTP 1.1</h4><ol>
<li>可扩展性</li>
<li>缓存</li>
<li>带宽优化</li>
<li>长连接</li>
<li>消息传递</li>
<li>Host 头域</li>
<li>错误提示</li>
<li>内容协商</li>
</ol>
<p>详情参见：</p>
<ul>
<li><a href="http://stackoverflow.com/questions/246859/http-1-0-vs-1-1" target="_blank" rel="external">HTTP 1.0 vs 1.1</a></li>
<li><a href="http://blog.csdn.net/forgotaboutgirl/article/details/6936982" target="_blank" rel="external">HTTP/1.1与HTTP/1.0的区别</a></li>
</ul>
<h4 id="1-2-2_HTTP_2-0">1.2.2  HTTP 2.0</h4><ol>
<li>二进制分帧</li>
<li>首部压缩</li>
<li>多路复用</li>
<li>并行双向字节流的请求和响应</li>
<li>请求优先级</li>
<li>服务器推送</li>
</ol>
<p>详情参见：</p>
<ul>
<li><a href="https://www.zhihu.com/question/34074946" target="_blank" rel="external">HTTP/2.0 相比1.0有哪些重大改进？</a></li>
<li><a href="http://www.alloyteam.com/2015/03/http2-0-di-qi-miao-ri-chang/" target="_blank" rel="external">HTTP 2.0 的奇妙日常</a></li>
</ul>
<h3 id="1-3_网络基础_TCP/IP">1.3  网络基础 TCP/IP</h3><p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-1.3.jpg" alt=""></p>
<p>图：TCP/IP 是互联网相关的各类协议族的总称</p>
<h4 id="1-3-1_TCP/IP_的分层管理">1.3.1 TCP/IP 的分层管理</h4><ul>
<li><p>应用层：决定了向用户提供应用服务时通信的活动</p>
</li>
<li><p>传输层：对上层应用层，提供处于网络连接中的两台计算机之间的数据传输</p>
</li>
<li><p>网络层（又名网络互连层）：用来处理在网络上流动的数据包</p>
</li>
<li><p>链路层（又名数据链路层，网络接口层）：用来处理连接网络的硬件部分</p>
</li>
</ul>
<h4 id="1-3-2_TCP/IP_通信传输流">1.3.2  TCP/IP 通信传输流</h4><p>利用 TCP/IP 协议族进行网络通信时，会通过分层顺序与对方进行通信。发送端从应用层往下走，接收端则往应用层往上走。</p>
<p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-1.3.2.jpg" alt=""></p>
<p>发送端在层与层之间传输数据时，每经过一层时必定会被打上一个该层所属的首部信息。反之，接收端在层与层传输数据时，每经过一层时会把对应的首部消去。</p>
<h3 id="1-4_与_HTTP_关系密切的协议：IP、TCP_和_DNS">1.4  与 HTTP 关系密切的协议：IP、TCP 和 DNS</h3><p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-1.4.1.jpg" alt=""></p>
<h4 id="1-4-1_负责传输的_IP_协议">1.4.1  负责传输的 IP 协议</h4><p>在进行中转时，会利用下一站中转设备的 MAC 地址来搜索下一个中转目标。这时，会采用 ARP 协议（Address Resolution Protocol）。ARP 是一种用以解析地址的协议，根据通信方的 IP 地址就可以反查出对应的 MAC 地址。</p>
<h4 id="1-4-2_确保可靠性的_TCP_协议">1.4.2  确保可靠性的 TCP 协议</h4><p>为了准确无误地将数据送达目标处，TCP 协议采用了三次握手（three-way handshaking）策略。</p>
<p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-1.4.2.jpg" alt=""></p>
<h5 id="1-4-2-1_为何要三次握手">1.4.2.1  为何要三次握手</h5><ol>
<li><p>为了防止已失效的连接请求报文段（上一个 TCP 连接）突然又传送到了服务端，因而产生错误（服务端白白等待）</p>
</li>
<li><p>也可假设想场景：两个人打电话</p>
</li>
</ol>
<h5 id="1-4-2-2_为何要四次分手">1.4.2.2 为何要四次分手</h5><ol>
<li><p>保证 TCP 协议的全双工连接能够可靠关闭</p>
</li>
<li><p>保证这次连接的重复数据段从网络中消失</p>
</li>
<li><p>TCP 连接是全双工的，这就意味着，当主机 1 发出 FIN 报文段时，只是表示主机 1 已经没有数据要发送了，但是，这个时候主机 1 还是可以接受来自主机 2 的数据；当主机 2 返回 ACK 报文段时，表示它已经知道主机 1 没有数据发送了，但是主机 2 还是可以发送数据到主机 1 的；当主机 2 也发送了 FIN 报文段时，这个时候就表示主机 2 也没有数据要发送了，就会告诉主机 1，我也没有数据要发送了，之后彼此就会愉快的中断这次 TCP 连接</p>
</li>
</ol>
<p>详情参见：</p>
<ul>
<li><a href="http://www.jellythink.com/archives/705" target="_blank" rel="external">简析TCP的三次握手与四次分手</a></li>
</ul>
<h5 id="1-4-2-3_为什么最后还要等待两个时间周期呢？">1.4.2.3 为什么最后还要等待两个时间周期呢？</h5><h3 id="1-5_负责域名解析的_DNS_服务">1.5  负责域名解析的 DNS 服务</h3><p>DNS（Domain Name System）服务是和 HTTP 协议一样位于应用层的协议。它提供域名到 IP 地址之间的解析服务。</p>
<h3 id="1-6_各种协议与_HTTP_协议的关系">1.6 各种协议与 HTTP 协议的关系</h3><p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-1.6.jpg" alt=""></p>
<h3 id="1-7_URI_和_URL">1.7  URI 和 URL</h3><p>URI 用字符串标识某一互联网资源，而 URL 表示资源的地点（互联网上所处的位置）。<br>URL 是 URI 的子集。<br>区别就是 URI 定义资源，而 URL 不单定义这个资源，还定义了如何找到这个资源（既访问资源的方式）。</p>
<p>详情参见：</p>
<ul>
<li><a href="http://www.cnblogs.com/youmeng/p/4891788.html" target="_blank" rel="external">Http权威指南笔记(一) URI URL URN 关系</a></li>
</ul>
<hr>
<h2 id="第_2_章_简单的_HTTP_协议">第 2 章  简单的 HTTP 协议</h2><h3 id="2-1_HTTP_请求和响应报文格式">2.1  HTTP 请求和响应报文格式</h3><p>HTTP 请求报文由请求行、请求头部、空行和请求包体 4 个部分组成，如下图所示：</p>
<p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-2.1.1.jpg" alt=""></p>
<p>HTTP 响应报文由状态行、响应头部、空行和响应包体 4 个部分组成，如下图所示：</p>
<p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-2.1.2.jpg" alt=""></p>
<p>详情参见：</p>
<ul>
<li><a href="http://www.cnblogs.com/biyeymyhjob/archive/2012/07/28/2612910.html" target="_blank" rel="external">HTTP请求报文和HTTP响应报文</a></li>
</ul>
<h3 id="2-2_告知服务器意图的_HTTP_方法">2.2  告知服务器意图的 HTTP 方法</h3><p>表 2-1：HTTP/1.0 和 HTTP/1.1 支持的方法</p>
<table>
<thead>
<tr>
<th>方法</th>
<th style="text-align:center">说明</th>
<th style="text-align:center">支持的 HTTP 协议版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td style="text-align:center">获取资源</td>
<td style="text-align:center">1.0、1.1</td>
</tr>
<tr>
<td>POST</td>
<td style="text-align:center">传输实体主体</td>
<td style="text-align:center">1.0、1.1</td>
</tr>
<tr>
<td>PUT</td>
<td style="text-align:center">传输文件</td>
<td style="text-align:center">1.0、1.1</td>
</tr>
<tr>
<td>HEAD</td>
<td style="text-align:center">获得报文首部</td>
<td style="text-align:center">1.0、1.1</td>
</tr>
<tr>
<td>DELETE</td>
<td style="text-align:center">删除文件</td>
<td style="text-align:center">1.0、1.1</td>
</tr>
<tr>
<td>OPTIONS</td>
<td style="text-align:center">询问支持的方法</td>
<td style="text-align:center">1.1</td>
</tr>
<tr>
<td>TRACE</td>
<td style="text-align:center">追踪路径</td>
<td style="text-align:center">1.1</td>
</tr>
<tr>
<td>CONNECT</td>
<td style="text-align:center">要求用隧道协议连接代理</td>
<td style="text-align:center">1.1</td>
</tr>
<tr>
<td>LINK</td>
<td style="text-align:center">建立和资源之间的联系</td>
<td style="text-align:center">1.0</td>
</tr>
<tr>
<td>UNLINK</td>
<td style="text-align:center">断开连接关系</td>
<td style="text-align:center">1.0</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="第_3_章_HTTP_报文内的_HTTP_信息">第 3 章  HTTP 报文内的 HTTP 信息</h2><h3 id="3-1_编码提升传输速率">3.1  编码提升传输速率</h3><h4 id="3-1-1_压缩传输的内容编码">3.1.1  压缩传输的内容编码</h4><p>内容编码指明应用在实体内容上的编码格式，并保持实体信息原样压缩。内容编码后的实体由客户端接收并负责解码。</p>
<p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-3.1.1.jpg" alt=""></p>
<p>常用的内容编码有以下几种：</p>
<ol>
<li>gzip（GNU zip）</li>
<li>compress（UNIX 系统的标准压缩）</li>
<li>deflate（zlib）</li>
<li>identity（不进行编码）</li>
</ol>
<h4 id="3-1-2_分割发送的分块传输编码">3.1.2  分割发送的分块传输编码</h4><p>在 HTTP 通信过程中，请求的编码实体资源尚未全部传输完成之前，浏览器无法显示请求页面。在传输大容量数据时，通过把数据分割成多块，能够让浏览器逐步显示页面。</p>
<p><img src="http://7xikfc.com1.z0.glb.clouddn.com/http-3.1.2.jpg" alt=""></p>
<h3 id="3-2_获取部分内容的范围请求">3.2  获取部分内容的范围请求</h3><p>执行范围请求时，会用到首部字段 Range 来指定资源的 byte 范围。</p>
<p>针对范围请求，响应会返回状态码为 206 Partial Content 的响应报文。另外，对于多重范围的范围请求，响应会在首部字段 Content-Type 标明 multipart/byteranges 后返回响应报文。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2016/04/05/the-notes-of-learning-illustrating-http-two/" class="prev">上一篇</a><a href="/2016/04/01/from-nsurlconnection-to-nsurlsession/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'tangqi92githubio';
var disqus_identifier = '2016/04/04/the-notes-of-learning-illustrating-http-one/';
var disqus_title = '《图解 HTTP》读书笔记（一）';
var disqus_url = 'http://imtangqi.com/2016/04/04/the-notes-of-learning-illustrating-http-one/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//tangqi92githubio.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2017 <a href="http://imtangqi.com">Qi Tang</a></p><p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-61827851-1",'auto');ga('send','pageview');</script></body></html>